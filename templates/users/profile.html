{% extends 'base/base.html' %}

{% block title %}Профиль{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h2>Профиль</h2>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Информация пользователя</h5>
            </div>
            <div class="card-body">
                <p><strong>Имя пользователя:</strong> {{ user.username }}</p>
                <p><strong>Email:</strong> {{ user.email|default:"Не указан" }}</p>
                <p><strong>Дата регистрации:</strong> {{ user.date_joined|date:"d.m.Y" }}</p>
                <p><strong>Последний вход:</strong> {{ user.last_login|date:"d.m.Y H:i"|default:"Неизвестно" }}</p>
                <p><strong>Био:</strong> {{ user.profile.bio|linebreaks|default:"Не указано" }}</p>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <a href="{% url 'edit_profile' %}" class="btn btn-primary">
                        <i class="bi bi-pencil"></i> Редактировать профиль
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Статистика задач</h5>
            </div>
            <div class="card-body">
                <p><strong>Всего задач:</strong> {{ user.tasks.count }}</p>
                <p><strong>Выполненных задач:</strong> {{ completed_tasks_count }}</p>
                <p><strong>Активных задач:</strong> {{ active_tasks_count }}</p>
                
                <div class="progress mb-3">
                    <div class="progress-bar bg-success" role="progressbar" 
                         style="width: {% if user.tasks.count > 0 %}{{ completed_tasks_count|floatformat:0 }}{% else %}0{% endif %}%;"
                         aria-valuenow="{% if user.tasks.count > 0 %}{{ completed_tasks_count|floatformat:0 }}{% else %}0{% endif %}" 
                         aria-valuemin="0" aria-valuemax="100">
                        {% if user.tasks.count > 0 %}{{ completed_tasks_count|floatformat:0 }}%{% else %}0%{% endif %}
                    </div>
                </div>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <a href="{% url 'task_list' %}" class="btn btn-secondary">
                        <i class="bi bi-list-task"></i> Мои задачи
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 